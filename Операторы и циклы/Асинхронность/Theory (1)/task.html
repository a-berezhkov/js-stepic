<h1>HTTP</h1>

<p>Рассмотрим, что же происходит когда мы вводим какой-то адрес в браузере. Каждый адрес привязан к определенному ip-адресу сервера, где лежит наше web-приложение. К примеру, для сайта ya.ru это будет адрес 87.250.250.242.  Запрос к серверу посылается при помощи HTTP протокола (Протокол передачи гипертекста).</p>

<blockquote>
<p><strong><dfn>Hypertext Transfer Protocol , HTTP</dfn></strong> - это прикладной протокол для передачи гипертекстовых документов, таких как HTML. Он создан для связи между веб-браузерами и веб-серверами, хотя в принципе HTTP может использоваться и для других целей. Протокол следует классической клиент-серверной модели, когда клиент открывает соединение для создания запроса, а затем ждёт ответа. HTTP - это протокол без сохранения состояния, то есть сервер не сохраняет никаких данных (состояние) между двумя парами "запрос-ответ".</p>
</blockquote>

<p>Сама идея очень хорошо представлена на рисунке ниже</p>

<p style="text-align: center;"><img alt="" height="510" name="image.png" src="https://ucarecdn.com/dc2a106b-e797-4250-856c-b70114455b01/" width="867"></p>

<p>С помощью специальных запросов запрашиваются различные данные с серверов. В действие  это можно посмотреть во вкладке инструментов разработчика "Network"</p>

<p style="text-align: center;"><img alt="" height="1340" name="image.png" src="https://ucarecdn.com/170ba9aa-21b5-452a-8d5c-d59a11aab860/" width="2868"></p>

<p>Здесь выделено два запроса - первый на получение самой страницы, второй - на загрузка шрифта.  Аналогично загружаются картинки, стили, скрипты и стили. Так же сразу видно адрес сервера (Remote Address) - 87.250.250.242. </p>

<h2>Как происходит, что браузер узнает адрес сервер для доменного имени?</h2>

<p>При вводе адреса такой информации еще не существует.</p>

<p>Такая информация хранится в распределенной системе серверов — DNS (Domain Name System). Система работает как общая «контактная книга», хранящаяся на распределенных серверах и устройствах в интернете.</p>

<p>Однако перед тем, как обращаться к DNS, браузер пытается найти запись об IP-адресе сайта в ближайших местах, чтобы сэкономить время:</p>

<ul>
	<li>Сначала в своей истории подключений. Если пользователь уже посещал сайт, то в браузере могла сохраниться информация c IP-адресом сервера.</li>
	<li>В операционной системе. Не обнаружив информации у себя, браузер обращается к операционной системе, которая также могла сохранить у себя DNS-запись. Например, если подключение с сайтом устанавливалось через одно из установленных на компьютере приложений.</li>
	<li>В кэше роутера, который сохраняет информацию о последних соединениях, совершенных из локальной сети.</li>
</ul>

<p>Не обнаружив подходящих записей в кэше, браузер формирует запрос к DNS-серверам, расположенным в интернете.</p>

<p>Например, если нужно найти IP-адрес сайта mail.vc.ru, браузер спрашивает у ближайшего DNS-сервера «Какой IP-адрес у сайта <a href="http://mail.vc.ru/" rel="nofollow noreferrer noopener" target="_blank">mail.vc.ru</a>?».</p>

<p>Сервер может ответить: «Я не знаю про <a href="http://mail.vc.ru/" rel="nofollow noreferrer noopener" target="_blank">mail.vc.ru</a>, но знаю сервер, который отвечает за <a href="http://vc.ru/" rel="nofollow noreferrer noopener" target="_blank">vc.ru</a>». Запрос переадресовывается дальше, на сервер «выше», пока в итоге один из серверов не найдет ответ об IP-адресе для сайта.</p>

<p> <img alt="" height="604" name="image.png" src="https://ucarecdn.com/ec3a5d10-216b-420f-aec7-8e467489da48/" width="1080"></p>

<h2> </h2>

<p>4. Браузер устанавливает соединение с сервером</p>

<p>Как только браузер узнал IP-адрес нужного сервера, он пытается установить с ним соединение. В большинстве случаев для этого используется специальный протокол — TCP.</p>

<p>TCP — это набор правил, который описывает способы соединения между устройствами, форматы отправки запросов, действия в случае потери данных и так далее.</p>

<p>Например, для установки соединения между браузером и сервером в стандарте TCP используется система «трёх рукопожатий». Работает она так:</p>

<ul>
	<li>Устройство пользователя отправляет специальный запрос на установку соединения с сервером — называется SYN-пакет.</li>
	<li>Сервер в ответ отправляет запрос с подтверждением получения SYN-пакета — называется SYN/ACK-пакет.</li>
	<li>В конце устройство пользователя при получении SYN/ACK-пакета отправляет пакет с подтверждением — ACK-пакет. В этот момент соединение считается установленным.</li>
</ul>

<h2> </h2>

<p>5. Браузер отправляет HTTP-запрос, чтобы получить контент сайта</p>

<p>После установки соединения браузер отправляет специальный запрос, в котором просит сервер отправить данные для отображения страницы. В этом запросе содержится информация о самом браузере, временные файлы, требования к соединению и так далее.</p>

<p>Задача браузера — как можно подробнее объяснить серверу, какая именно информация ему нужна.</p>

<p>В общении браузера и сервера выделяют два типа запросов. GET-запрос используется для получения данных с сервера — например, отобразить картинку, текст или видео. POST-запрос — используется для отправки данных из браузера на сервер, например, когда пользователь отправляет сообщение, картинку или загружает файл.</p>

<h2> </h2>

<p>6. Сервер обрабатывает запрос</p>

<p>Сервер получил запрос от браузера с подробным описанием того, что ему требуется. Теперь ему нужно обработать этот запрос. Этой задачей занимается специальное серверное программное обеспечение — например, nginx или Apache. Чаще всего такие программы принято называть веб-серверами.</p>

<p>Веб-сервер в свою очередь перенаправляет запрос на дальнейшую обработку к программе-обработчику — например, PHP, Ruby или ASP.NET. Программа внимательно изучает содержимое запроса — например, понимает, в каком формате нужно отправить ответ и какие именно файлы нужны. И собирает ответ.</p>

<h2> </h2>

<p>7. Сервер отправляет ответ браузеру</p>

<p>Когда ответ сформирован, он отправляется веб-сервером обратно браузеру. В ответе как правило содержится контент для отображения веб-страницы, информация о типе сжатия данных, способах кэширования, файлы cookie, которые нужно записать и так далее.</p>

<p>👉 Чтобы обмен данными был быстрым, браузер и сервер обмениваются сразу множеством небольших пакетов данных — как правило, в пределах 8 КБ. Все пакеты имеют специальные номера, которые помогают отслеживать последовательность отправки и получения данных.</p>

<h2> </h2>

<p>8. Браузер обрабатывает полученный ответ и «рисует» веб-страницу</p>

<p>Браузер распаковывает полученный ответ и постепенно начинает отображать полученный контент на экране пользователя — этот процесс называется рендерингом.</p>

<p>Сначала браузер загружает только основную структуру HTML-страницы. Затем последовательно проверяет все теги и отправляет дополнительные GET-запросы для получения с сервера различных элементов — картинки, файлы, скрипты, таблицы стилей и так далее. Поэтому по мере загрузки страницы браузер и сервер продолжают обмениваться между собой информацией.</p>

<p>Параллельно с этим на компьютер как правило сохраняются статичные файлы пользователя — чтобы при следующем посещении не загружать их заново и быстрее отобразить пользователю содержимое страницы.</p>

<p>Как только рендеринг завершен — пользователю отобразится полностью загруженная страница сайта.</p>